"use strict";var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),QC;!function(a){var b=!1;a.LOCATIONS={LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom",FULL:"full"},a.config={overrideNativeCalls:!0,location:a.LOCATIONS.LEFT,maxMessageCount:50,maxConsoleHistory:40},a.init=function(c,d){if(a.config.location=c.location||a.config.location,a.overrideNativeCalls=c.overrideNativeCalls||a.config.overrideNativeCalls,!b){var e=a.DI.load("setup");e.registerKeyHandler(d),b=!0}}}(QC||(QC={}));var quickConsole=QC,QC;!function(a){function b(){this.statics=[],this.buildable=[],this.registered=[]}b.prototype.register=function(a,b,c){this.buildable[a]={name:a,func:b,dependencies:c||[]},this.registered.push(this.buildable[a])},b.prototype.registerStatic=function(a,b){this.statics[a]=b},b.prototype.load=function(a){var b=this.statics[a];return b||(b=this.build(a),this.statics[a]=b),b},b.prototype.build=function(a){var b=this,c=this.buildable[a];if(!c)throw new Error("'"+a+"'  has not been registered!");var d=[];return c.dependencies&&c.dependencies.length&&c.dependencies.forEach(function(a){var c=b.load(a);d.push(c)}),new(c.func.bind.apply(c.func,[null].concat(d)))},b.prototype.getDependencyMap=function(){var a=this;return this.registered.map(function(b){var c=a.getDependencies(b.dependencies,[b.name],2);return b.name+":\n"+c}).join("\n")},b.prototype.getDependencies=function(a,b,c){var d=this;return a&&a.length||2!==c?a.map(function(a){if(b.indexOf(a)>-1)return Array(c).join("--")+"Recursive depency on: "+a+"\n";var e=b.slice(0);return e.push(a),Array(c).join("--")+a+"\n"+d.getDependencies(d.buildable[a].dependencies,e,c+1)}).join(""):Array(c).join("--")+"No Dependencies \n"},a.DI=new b}(QC||(QC={}));var QC;!function(QC){function Execute(a){this.clearFunctionsOptions=["clear();","clear()","Clear();","Clear()"],this.log=a,this.executor=this.executeEval}Execute.prototype.eval=function(a){return this.requestingClear(a)?void this.log.clear():void this.executor(a)},Execute.prototype.requestingClear=function(a){return this.clearFunctionsOptions.indexOf(a)>-1},Execute.prototype.executeEval=function(evalString){var response;try{response=eval(evalString)}catch(a){a.message&&a.message.indexOf("Refused to evaluate a string as JavaScript because 'unsafe-eval'")>-1&&(this.log.write("log","Eval is not allowed on this platform, defaulting to simple execution which only allow direct function calls with primitives as params"),this.executor=this.executeSafe,this.executeSafe(evalString)),this.log.write("error",a.message)}this.handleExecuteResponse(response)},Execute.prototype.executeSafe=function(a){var b=this;if(a.indexOf("(")>-1){var c=a.split("("),d=c[0],e=c&&c.length?c[1].split(")")[0].split(","):[];e=e.map(function(a){return b.parseParam(a)}).filter(function(a){return!!a}),this.executeFunction(d,e)}else this.logObject(a)},Execute.prototype.parseParam=function(a){return a&&a.length?this.isNumber(a)?a.indexOf(".")>-1?parseFloat(a):parseInt(a):this.sanitizeString(a):null},Execute.prototype.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},Execute.prototype.sanitizeString=function(a){return a.length?(a=a.trim(),'"'===a[0]||"'"===a[0]?this.sanitizeString(a.substr(1)):'"'===a[a.length-1]||"'"===a[a.length-1]?this.sanitizeString(a.slice(0,-1)):a):a},Execute.prototype.executeFunction=function(a,b){var c=window,d=window,e="window";a.split(".").forEach(function(a){return c[a]?(d=c,e+="."+a,void(c=c[a])):void console.error(a+" does not exist on object: "+e)});var f=c.apply(d,b);this.handleExecuteResponse(f)},Execute.prototype.logObject=function(a){var b=window,c="window";a.split(".").forEach(function(a){return b[a]?(c+="."+a,void(b=b[a])):void console.error(a+" does not exist on object: "+c)}),this.handleExecuteResponse(b)},Execute.prototype.handleExecuteResponse=function(a){var b=this;if(a)return a.then?void a.then(function(a){b.log.write("log",a)}):void this.log.write("log",a)},QC.DI.register("execute",Execute,["log"])}(QC||(QC={}));var QC;!function(a){function b(){this.spacer=String.fromCharCode(32)}b.prototype.message=function(a,b){return"string"==typeof a?a:this.isElement(a)?this.formatElement(a,b):this.formatJSON(a)},b.prototype.formatElement=function(a,b){var c=this,d="Element: Html"+String.fromCharCode(13)+Array(25).join("-"),e=0,f=a.outerHTML;return b&&(f=f.replace(b,"<quick-console>[...]</quick-console>")),d+f.replace(/(?:\r\n|\r|\n)/g,"#").replace(/>/g,">#").replace(/</g,"#<").replace(/##/g,"#").split("#").map(function(a){if(a=a.trim(),a[1]&&"/"===a[1]&&e>2)return e-=2,c.getSpacer(e)+a;if(a[0]&&"<"===a[0]&&"i"!==a[1]){var b=e;return e+=2,c.getSpacer(b)+a}return c.getSpacer(e)+a}).join(String.fromCharCode(13))},b.prototype.getSpacer=function(a){return Array(2*a).join(this.spacer)},b.prototype.isElement=function(a){return"undefined"!=typeof a.outerHTML},b.prototype.formatJSON=function(a){try{return JSON.stringify(a,null,4)}catch(a){return"Failed to serialize object"}},a.DI.register("format",b)}(QC||(QC={}));var QC;!function(a){function b(a){this.storage=a,this.consoleList=[],this.consoleIndex=0,this.maxConsoleHistory=40,this.loadSavedConsoleHistory()}b.prototype.loadSavedConsoleHistory=function(){var a=this.storage.retrieve("consoleHistory");a&&(this.consoleList=JSON.parse(a),this.consoleIndex=this.consoleList.length-1)},b.prototype.saveLast=function(b){b&&""!==b&&this.consoleList[this.consoleList.length-1]!==b&&(this.consoleList.length>=a.config.maxConsoleHistory&&this.consoleList.shift(),this.consoleList.push(b),this.consoleIndex=this.consoleList.length-1,this.storage.store("consoleHistory",JSON.stringify(this.consoleList)))},b.prototype.loadLast=function(){if(!this.consoleList.length)return"";var a=this.consoleList[this.consoleIndex];return this.consoleList.length>this.consoleIndex&&(this.consoleIndex+=1),a||""},b.prototype.loadNext=function(){if(!this.consoleList.length)return"";var a=this.consoleList[this.consoleIndex];return this.consoleIndex=this.consoleIndex>0?this.consoleIndex-1:0,a||""},a.DI.register("history",b,["storage"])}(QC||(QC={}));var QC;!function(a){function b(a,b,c){this.execute=a,this.history=b,this.suggest=c}b.prototype.updateInputText=function(b,c,d){if(!a.DI.load("setup").checkForConsoleToggle(b)){switch(b.key){case"Enter":this.handleReturnKey(c);break;case"ArrowDown":c.value=this.history.loadLast();break;case"ArrowUp":c.value=this.history.loadNext();break;case"Tab":this.handleTabCompletion(b,c);break;case"z":if(!b.ctrlKey)return;c.value=this.lastValue;break;default:return void this.updateSuggestionsAfterTimeout(c,d)}this.moveCursorToEnd(c,d)}},b.prototype.handleReturnKey=function(a){this.history.saveLast(a.value);try{this.execute.eval(a.value)}catch(a){}a.value=""},b.prototype.handleTabCompletion=function(a,b){this.lastValue=b.value;var c=this.suggest.getSuggestion(b.value);b.value=c.getAutoCompetion(),a.preventDefault(),b.focus()},b.prototype.moveCursorToEnd=function(a,b){a.focus(),b.innerText="",setTimeout(function(){a.value=a.value},20)},b.prototype.updateSuggestionsAfterTimeout=function(a,b){var c=this;clearTimeout(this.suggestionTimeoutId),this.suggestionTimeoutId=setTimeout(function(){c.populateHint(b,c.suggest.getSuggestion(a.value))},50)},b.prototype.populateHint=function(a,b){b.suggestions&&(a.innerText=b.getAutoCompetion())},a.DI.register("inputHandler",b,["execute","history","suggest"])}(QC||(QC={}));var QC;!function(a){function b(a,b){this.format=a,this.storage=b,this.logList=[]}b.prototype.write=function(b,c){var d=b.toUpperCase()+": "+this.format.message(c,this.getView().getViewAsString());this.addToLogList(d),this.getView().logToScreen(this.logList),a.innerConsole[b]&&!a.config.overrideNativeCalls&&a.innerConsole[b](c)},b.prototype.getView=function(){return this.view||(this.view=a.DI.load("view")),this.view},b.prototype.error=function(b,c,d,e){this.write("error",["errorMsg: ",b,"url: ",c,"lineNumber: ",d,"column: ",e].join("\n")),a.innerConsole.onError&&a.innerConsole.onError(b,c,d,e)},b.prototype.clear=function(){this.storage.store("consoleMsg",JSON.stringify(this.logList)),a.innerConsole.clear&&a.innerConsole.clear(),this.logList=[];var b=a.DI.load("view");b.logToScreen(this.logList)},b.prototype.addToLogList=function(b){this.logList.length>=a.config.maxMessageCount&&this.logList.pop(),this.logList.unshift(b)},a.DI.register("log",b,["format","storage"])}(QC||(QC={}));var QC;!function(a){function b(b,c){this.log=b,this.view=c,a.init=this.init,this.captureNativeConsole(),this.registered=!1,this.overrideNativeConsole(),this.toggleConsoleTimeout}b.prototype.overrideNativeConsole=function(){var a=this;console.log=function(b){return a.log.write("log",b)},console.error=function(b){return a.log.write("error",b)},console.warn=function(b){return a.log.write("warn",b)},console.info=function(b){return a.log.write("info",b)},console.clear=this.log.clear,window.onerror=function(b,c,d,e){return a.log.error(b,c,d,e)}},b.prototype.captureNativeConsole=function(){a.innerConsole={log:console.log,error:console.error,warn:console.warn,info:console.info,clear:console.clear,onError:window.onerror}},b.prototype.registerToggleHandler=function(a){this.registered||(this.registerKeyHandler(window),this.registered=!0),a&&this.registerKeyHandler(a)},b.prototype.registerKeyHandler=function(a){var b=this,c=a||window,d=c.onkeydown;c.onkeyup=function(a){b.checkForConsoleToggle(a),d&&d(a)}},b.prototype.checkForConsoleToggle=function(a){var b=this;return!!(a.shiftKey&&a.altKey&&a.ctrlKey&&68===a.keyCode)&&(clearTimeout(this.toggleConsoleTimeout),this.toggleConsoleTimeout=setTimeout(function(){b.view.toggleConsole()},200),!0)},a.DI.register("setup",b,["log","view"])}(QC||(QC={}));var QC;!function(a){function b(){}b.prototype.store=function(a,b){return!!this.useLocalStorage()&&(localStorage.setItem(a,b),!0)},b.prototype.retrieve=function(a,b){if(!this.useLocalStorage())return b;var c=localStorage.getItem(a);return"undefined"==typeof c&&"undefined"!=typeof c?b:c},b.prototype.useLocalStorage=function(){var a=!1;try{a="undefined"!=typeof localStorage}catch(a){}return a},a.DI.register("storage",b,[])}(QC||(QC={}));var QC;!function(a){var b={container:{position:"absolute",background:"rgba(250, 250, 250, .87)","z-index":2e3,overflow:"auto",color:"#404040"},textArea:{position:"absolute",background:"rgba(250, 250, 250, 0.87)",rect:"5px 50px calc(100% - 20px) calc(100% - 60px)"},input:{position:"relative",rect:"0 0 calc(100% - 35px) 20px",border:"1px solid rgba(90, 90, 90, 0.7);",padding:"5px",margin:"1%","z-index":2,font:"1em arial",outline:"none","background-color":"transparent"},completionHint:{position:"absolute",rect:"0 0 80% 20px","z-index":2,color:"rgba(40, 40, 40, 0.7)",font:"1em arial","line-height":"20px",margin:"1%",padding:"6px"},left:{rect:"0 0 50% 100%"},right:{rect:"50% 0 50% 100%"},top:{rect:"0 0 100% 50%"},bottom:{rect:"0 50% 100% 50%"},full:{rect:"0 0 100% 100%"}};a.DI.registerStatic("style",b)}(QC||(QC={}));var QC;!function(a){function b(a){console.log(a),this.style=a}b.prototype.get=function(a){return console.log(this.toStyle(this.style[a])),this.toStyle(this.style[a])},b.prototype.set=function(a,b){a.setAttribute("style",this.get(b))},b.prototype.toStyle=function(a){var b=this,c=Object.keys(a);return c.map(function(c){return b.toStyleRule(c,a[c])}).join(" ")},b.prototype.toStyleRule=function(a,b){if("rect"===a){console.log(a+" "+b);var c=this.getRectStylesAsArray(b),d=_slicedToArray(c,4),e=d[0],f=d[1],g=d[2],h=d[3];return this.getRect(e,f,g,h)}return a+":"+b+";"},b.prototype.setContainerStyle=function(a){this.style.container.rect=this.getConsolePosition(),a.setAttribute("style",this.toStyle(this.style.container))},b.prototype.getRect=function(a,b,c,d){return[this.toStyleRule("left",a),this.toStyleRule("top",b),this.toStyleRule("width",c),this.toStyleRule("height",d)].join(" ")},b.prototype.getRectStylesAsArray=function(a){console.log(a);var b=a.split(" ");return 4===b.length?b:b.reduce(function(a,b,c){if(a.last){var d=[a.last,b].join(" ");b.indexOf(")")>-1?(a.finalArray.push(d),a.last=null):a.last=d}else b.indexOf("(")>-1?a.last=b:a.finalArray.push(b);return a},{finalArray:[]}).finalArray},b.prototype.getConsolePosition=function(){switch(a.config.location){case a.LOCATIONS.LEFT:return this.style.left;case a.LOCATIONS.RIGHT:return this.style.right;case a.LOCATIONS.TOP:return this.style.top;case a.LOCATIONS.BOTTOM:return this.style.bottom;default:return this.style.full}},a.DI.register("styleUtil",b,["style"])}(QC||(QC={}));var QC;!function(a){function b(){}b.prototype.getSuggestion=function(b){var c=new a.Suggestion(b);return c.suggestions=this.getSuggestions(c.getLastCommand(),!0),c},b.prototype.getSuggestions=function(a,b){var c=this,d="";return a.split(".").reduce(function(a,e,f,g){return g.length===f+1?c.getSuggestionsForName(a,e):a[e]?(d+=""!==d?"."+e:e,a[e]):(b||console.error(e+" does not exist on object: "+d),null)},window)},b.prototype.getSuggestionsForName=function(a,b){var c=this.getContextualSuggestions(a),d=c.filter(function(a){return 0===a.toUpperCase().indexOf(b.toUpperCase())});return d||[b]},b.prototype.getContextualSuggestions=function(a){var b=[];for(var c in a)b.push(c);return b},a.DI.register("suggest",b,[])}(QC||(QC={}));var QC;!function(a){function b(a){this.fullCommand=a,this.commandsToComplete=this.getLastCommand()}b.prototype.getLastCommand=function(){if(!this.fullCommand||""===this.fullCommand)return"";var a=this.fullCommand.split(" ");return a.pop()},b.prototype.getAutoCompetion=function(){var a=this;return this.suggestions&&this.suggestions.length?this.fullCommand.split(".").map(function(b,c,d){return d.length===c+1?a.getBestSuggestion()||b:b}).join("."):this.fullCommand},b.prototype.getBestSuggestion=function(){return this.suggestions&&this.suggestions.length?this.suggestions.sort(function(a,b){return a.length-b.length})[0]:null},a.Suggestion=b}(QC||(QC={}));var QC;!function(a){function b(b,c,d){a.setLocation=this.setLocation,this.execute=b,this.inputHandler=c,this.styleUtil=d}b.prototype.addToScreen=function(){this.consoleContainer=document.createElement("div"),this.styleUtil.setContainerStyle(this.consoleContainer),document.body.appendChild(this.consoleContainer),this.consoleDiv=document.createElement("textarea"),this.consoleDiv.setAttribute("readonly",""),this.styleUtil.set(this.consoleDiv,"textArea"),this.consoleContainer.appendChild(this.consoleDiv),this.addInput()},b.prototype.addInput=function(){var a=this;this.addCompletionHint(),this.input=document.createElement("input"),this.input.setAttribute("id","consoleInput"),this.input.setAttribute("type","text"),this.styleUtil.set(this.input,"input"),this.consoleContainer.appendChild(this.input),this.input.onkeydown=function(b){a.inputHandler.updateInputText(b,a.input,a.completionHint)}},b.prototype.addCompletionHint=function(){this.completionHint=document.createElement("div"),this.styleUtil.set(this.completionHint,"completionHint"),this.consoleContainer.appendChild(this.completionHint)},b.prototype.setLocation=function(b){a.config.location=b,this.consoleContainer&&this.styleUtil.setContainerStyle(this.consoleContainer)},b.prototype.logToScreen=function(a){this.consoleDiv&&(this.consoleDiv.innerText=a.join(this.getSeperator()))},b.prototype.getSeperator=function(){return this.logSeperator||(this.logSeperator=String.fromCharCode(13)+Array(50).join("=")+String.fromCharCode(13)),this.logSeperator},b.prototype.toggleConsole=function(){this.consoleContainer?(this.consoleContainer.remove(),this.consoleContainer=void 0):(this.addToScreen(),this.input.focus())},b.prototype.getViewAsString=function(){return this.consoleContainer?this.consoleContainer.outerHTML:""},a.DI.register("view",b,["execute","inputHandler","styleUtil"])}(QC||(QC={}));